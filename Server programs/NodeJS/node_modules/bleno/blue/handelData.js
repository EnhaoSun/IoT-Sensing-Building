var moment = require('moment');
var mysql = require('mysql');
var connection = mysql.createConnection({
	host	: 'localhost',
	user	: 'root',
	password: '',
	database: 'testdb'
});

connection.connect();
console.log("success");

var table_name1 = "MobileAccelerometer"; // create a table
var table_name2 = "RoomStatus"; 

var insert_sql = "INSERT INTO " +table_name+ "(date, max,may,maz) VALUES ?";
var select_sql = "SEKECT top 1 * FROM " + table_name + " order by ts desc"; // select last record in database 
function handeldata(){

    this.insert = function(x, y, z){
		var time = moment().format('YYYY-MM-DD HH:mm:ss');
		var values = [[time, x, y, z]];
		connection.query(insert_sql, [values], function (err, result){
			if(err) throw err;
        	console.log("number of records inserted: " + result.affectedRows);
		});
    };

    this.select = function(){
		connection.query(sqlect_sql, function (err, results, fields){
			if(err) throw err;
        	console.log(results);
		});
		for (var result in results){
			return result;
		};
    };
};

module.exports = handeldata;
